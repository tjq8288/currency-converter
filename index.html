<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Basic Meta Tags -->
    <meta name="robots" content="index, follow">
    <meta name="author" content="tjq8288">
    <meta name="theme-color" content="#0f766e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="환율 변환기">
    
    <!-- SEO Meta Tags will be dynamically updated by JavaScript -->
    <title>환율 변환기 - 실시간 환율 및 암호화폐 계산기</title>
    <meta name="description" content="200+ 통화와 50+ 암호화폐 실시간 환율 변환기. 여행, 투자, 쇼핑을 위한 무료 온라인 계산기. 12개 언어 지원.">
    <meta name="keywords" content="환율 변환기, 환율 계산기, 암호화폐 변환기, 비트코인 환율, 실시간 환율, currency converter">

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="환율 변환기 - 실시간 환율 및 암호화폐 계산기">
    <meta property="og:description" content="200+ 통화와 50+ 암호화폐 실시간 환율 변환. 여행과 투자를 위한 무료 도구.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tjq8288.github.io/currency-converter/">
    <meta property="og:image" content="https://tjq8288.github.io/currency-converter/og-image.png">
    <meta property="og:site_name" content="환율 변환기">
    <meta property="og:locale" content="ko_KR">

    <!-- Twitter Card Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="환율 변환기 - 실시간 환율 및 암호화폐 계산기">
    <meta name="twitter:description" content="200+ 통화와 50+ 암호화폐 실시간 환율 변환기">
    <meta name="twitter:image" content="https://tjq8288.github.io/currency-converter/og-image.png">

    <!-- Hreflang links will be generated by JavaScript -->
    <link rel="canonical" href="https://tjq8288.github.io/currency-converter/">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iOCIgZmlsbD0iIzBmNzY2ZSIvPgo8dGV4dCB4PSI1IiB5PSIyMiIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTgiIGZvbnQtd2VpZ2h0PSJib2xkIiBmaWxsPSJ3aGl0ZSI+JDwvdGV4dD4KPC9zdmc+">

    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Currency Converter",
      "alternateName": "환율 변환기",
      "description": "Free online currency converter with real-time exchange rates for 200+ currencies and 50+ cryptocurrencies",
      "url": "https://tjq8288.github.io/currency-converter/",
      "applicationCategory": "FinanceApplication",
      "operatingSystem": "Any",
      "browserRequirements": "Requires JavaScript",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD",
        "availability": "https://schema.org/InStock"
      },
      "creator": {
        "@type": "Organization",
        "name": "tjq8288"
      },
      "keywords": "currency converter, exchange rate, cryptocurrency, bitcoin, real-time rates",
      "inLanguage": ["ko", "en", "zh", "es", "ar", "pt", "hi", "id", "de", "fr", "ja", "ru"],
      "featureList": [
        "Real-time exchange rates",
        "200+ fiat currencies",
        "50+ cryptocurrencies", 
        "12 languages support",
        "Mobile responsive",
        "Free to use"
      ]
    }
    </script>

    <!-- Breadcrumb Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "https://tjq8288.github.io/currency-converter/"
      }]
    }
    </script>

    <!-- FAQ Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [{
        "@type": "Question",
        "name": "How accurate are the exchange rates?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Our exchange rates are updated in real-time using reliable financial data sources, ensuring high accuracy for your currency conversions."
        }
      }, {
        "@type": "Question", 
        "name": "Which currencies are supported?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "We support over 200 fiat currencies including USD, EUR, GBP, JPY, KRW, and 50+ cryptocurrencies including Bitcoin, Ethereum, and more."
        }
      }, {
        "@type": "Question",
        "name": "Is the currency converter free to use?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Yes, our currency converter is completely free to use with no hidden fees or registration required."
        }
      }]
    }
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: white;
            min-height: 100vh;
            padding: 20px;
            color: #2c3e50;
            line-height: 1.6;
        }

        /* RTL support for Arabic */
        body[dir="rtl"] {
            direction: rtl;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            animation: slideUp 0.6s ease-out;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header {
            background: linear-gradient(135deg, #0f766e 0%, #0891b2 100%);
            color: white;
            text-align: center;
            padding: 40px 30px;
            position: relative;
        }

        #language-selector {
            position: absolute; 
            top: 15px; 
            right: 15px; 
        }

        body[dir="rtl"] #language-selector {
            right: auto;
            left: 15px;
        }

        #lang-switcher {
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.3);
            background-color: rgba(0,0,0,0.2);
            color: white;
            font-size: 0.9rem;
            cursor: pointer;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            padding: 40px 30px;
        }

        .mode-toggle {
            display: flex;
            margin-bottom: 30px;
            background: #f1f5f9;
            border-radius: 12px;
            padding: 6px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.06);
        }

        .toggle-option {
            flex: 1;
            padding: 12px 20px;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 1rem;
        }

        .toggle-option.active {
            background: linear-gradient(135deg, #0f766e 0%, #0891b2 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(15, 118, 110, 0.3);
        }

        .toggle-option:not(.active) {
            color: #64748b;
        }

        .converter-section {
            background: #f8fafc;
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid #e2e8f0;
        }

        .currency-row {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 20px;
            align-items: center;
            margin-bottom: 20px;
        }

        .currency-input-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            position: relative;
        }

        /* Custom dropdown styles */
        .custom-select-container {
            position: relative;
        }

        .custom-select-button {
            width: 100%;
            padding: 12px 40px 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s ease;
            text-align: left;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .custom-select-button:hover {
            border-color: #14b8a6;
        }

        .custom-select-button:focus {
            outline: none;
            border-color: #0f766e;
            box-shadow: 0 0 0 3px rgba(15, 118, 110, 0.1);
        }

        .custom-select-arrow {
            transition: transform 0.3s ease;
        }

        .custom-select-button.open .custom-select-arrow {
            transform: rotate(180deg);
        }

        .custom-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid #e2e8f0;
            border-top: none;
            border-radius: 0 0 10px 10px;
            max-height: 250px;
            overflow: hidden;
            z-index: 1000;
            display: none;
        }

        .custom-dropdown.open {
            display: block;
        }

        .dropdown-search {
            padding: 10px;
            border-bottom: 1px solid #e2e8f0;
            background: #f8fafc;
        }

        .dropdown-search input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            font-size: 0.9rem;
            outline: none;
        }

        .dropdown-search input:focus {
            border-color: #0f766e;
        }

        .dropdown-options {
            max-height: 200px;
            overflow-y: auto;
        }

        .dropdown-option {
            padding: 10px 16px;
            cursor: pointer;
            transition: background-color 0.2s ease;
            border-bottom: 1px solid #f1f5f9;
        }

        .dropdown-option:hover {
            background: #f0fdfa;
        }

        .dropdown-option:last-child {
            border-bottom: none;
        }

        .dropdown-option.selected {
            background: #f0fdfa;
            color: #0f766e;
            font-weight: 600;
        }

        .amount-input {
            padding: 16px 20px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1.2rem;
            text-align: center;
            transition: border-color 0.3s ease;
            background: white;
        }

        .amount-input:focus {
            outline: none;
            border-color: #0f766e;
            box-shadow: 0 0 0 3px rgba(15, 118, 110, 0.1);
        }

        .amount-input.result {
            background: #f1f5f9;
            font-weight: 600;
            color: #1e293b;
        }

        .swap-button {
            width: 50px;
            height: 50px;
            border: none;
            border-radius: 50%;
            background: linear-gradient(135deg, #0f766e 0%, #0891b2 100%);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .swap-button:hover {
            transform: rotate(180deg) scale(1.1);
            box-shadow: 0 6px 20px rgba(15, 118, 110, 0.3);
        }

        .rate-info {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #e2e8f0;
            text-align: center;
        }

        .rate-text {
            font-size: 0.95rem;
            color: #64748b;
            margin-bottom: 8px;
        }

        .rate-value {
            font-size: 1.3rem;
            font-weight: 600;
            color: #1e293b;
        }

        .quick-amounts {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .quick-amount {
            padding: 8px 16px;
            border: 1px solid #e2e8f0;
            border-radius: 20px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .quick-amount:hover {
            border-color: #0f766e;
            background: #f0fdfa;
            color: #0f766e;
        }

        .favorites-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #e2e8f0;
        }

        .section-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: #1e293b;
        }

        .favorite-pairs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
        }

        .favorite-pair {
            padding: 10px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .favorite-pair:hover {
            border-color: #0f766e;
            background: #f0fdfa;
            color: #0f766e;
        }

        .history-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #e2e8f0;
        }

        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #f1f5f9;
        }

        .history-item:last-child {
            border-bottom: none;
        }

        .history-conversion {
            font-weight: 500;
        }

        .history-time {
            font-size: 0.8rem;
            color: #64748b;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #0f766e;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-message {
            background: #fef2f2;
            border: 1px solid #fecaca;
            color: #dc2626;
            padding: 12px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
        }

        .success-message {
            background: #f0fdf4;
            border: 1px solid #bbf7d0;
            color: #16a34a;
            padding: 12px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 12px;
            }
            
            .header {
                padding: 30px 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .main-content {
                padding: 30px 20px;
            }
            
            .currency-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .swap-button {
                justify-self: center;
                transform: rotate(90deg);
            }
            
            .favorite-pairs {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .hidden {
            display: none;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div id="language-selector"></div>
            <h1 data-translate="headerTitle">환율 변환기</h1>
            <p data-translate="headerSubtitle">실시간 환율 및 암호화폐 계산기</p>
        </header>

        <main class="main-content">
            <!-- Mode Toggle -->
            <div class="mode-toggle">
                <div class="toggle-option active" data-mode="fiat" data-translate="fiatMode">법정통화</div>
                <div class="toggle-option" data-mode="crypto" data-translate="cryptoMode">암호화폐</div>
            </div>

            <!-- Converter Section -->
            <div class="converter-section">
                <div class="currency-row">
                    <div class="currency-input-group">
                        <div class="custom-select-container">
                            <button class="custom-select-button" id="fromCurrencyButton">
                                <span id="fromCurrencyText">KRW - South Korean Won</span>
                                <span class="custom-select-arrow">▼</span>
                            </button>
                            <div class="custom-dropdown" id="fromCurrencyDropdown">
                                <div class="dropdown-search">
                                    <input type="text" id="fromCurrencySearch" placeholder="통화 검색...">
                                </div>
                                <div class="dropdown-options" id="fromCurrencyOptions"></div>
                            </div>
                        </div>
                        <input type="text" class="amount-input" id="fromAmount" placeholder="0" value="1000">
                    </div>
                    
                    <button class="swap-button" id="swapButton">⇄</button>
                    
                    <div class="currency-input-group">
                        <div class="custom-select-container">
                            <button class="custom-select-button" id="toCurrencyButton">
                                <span id="toCurrencyText">USD - US Dollar</span>
                                <span class="custom-select-arrow">▼</span>
                            </button>
                            <div class="custom-dropdown" id="toCurrencyDropdown">
                                <div class="dropdown-search">
                                    <input type="text" id="toCurrencySearch" placeholder="통화 검색...">
                                </div>
                                <div class="dropdown-options" id="toCurrencyOptions"></div>
                            </div>
                        </div>
                        <input type="text" class="amount-input result" id="toAmount" placeholder="0" readonly>
                    </div>
                </div>

                <div class="rate-info" id="rateInfo">
                    <div class="rate-text" data-translate="exchangeRate">환율</div>
                    <div class="rate-value" id="rateValue">-</div>
                </div>

                <div class="quick-amounts">
                    <div class="quick-amount" data-amount="1">1</div>
                    <div class="quick-amount" data-amount="10">10</div>
                    <div class="quick-amount" data-amount="100">100</div>
                    <div class="quick-amount" data-amount="1000">1,000</div>
                    <div class="quick-amount" data-amount="10000">10,000</div>
                </div>
            </div>

            <!-- Favorites Section -->
            <div class="favorites-section">
                <div class="section-title" data-translate="favoritePairs">인기 통화 쌍</div>
                <div class="favorite-pairs" id="favoritePairs"></div>
            </div>

            <!-- History Section -->
            <div class="history-section">
                <div class="section-title" data-translate="recentConversions">최근 변환</div>
                <div id="conversionHistory"></div>
            </div>
        </main>
    </div>

    <script>
document.addEventListener('DOMContentLoaded', () => {
    // --- TRANSLATIONS (12 Languages) ---
    const translations = {
        "ko": {
            "langCode": "ko", "dir": "ltr",
            "pageTitle": "환율 변환기 - 실시간 환율 및 암호화폐 계산기",
            "metaDescription": "200+ 통화와 50+ 암호화폐 실시간 환율 변환기. 여행, 투자, 쇼핑을 위한 무료 온라인 계산기. 12개 언어 지원.",
            "metaKeywords": "환율 변환기, 환율 계산기, 암호화폐 변환기, 비트코인 환율, 실시간 환율",
            "headerTitle": "환율 변환기",
            "headerSubtitle": "실시간 환율 및 암호화폐 계산기",
            "fiatMode": "법정통화",
            "cryptoMode": "암호화폐", 
            "exchangeRate": "환율",
            "favoritePairs": "인기 통화 쌍",
            "recentConversions": "최근 변환",
            "currency": "KRW",
            "currencySymbol": "₩",
            "locale": "ko-KR",
            "searchPlaceholder": "통화 검색..."
        },
        "en": {
            "langCode": "en", "dir": "ltr",
            "pageTitle": "Currency Converter - Real-Time Exchange Rates & Crypto Calculator",
            "metaDescription": "Convert 200+ currencies and 50+ cryptocurrencies with real-time exchange rates. Free online calculator for travel, trading, and shopping.",
            "metaKeywords": "currency converter, exchange rate, crypto converter, bitcoin, real time rates",
            "headerTitle": "Currency Converter",
            "headerSubtitle": "Real-Time Exchange Rates & Crypto Calculator",
            "fiatMode": "Fiat Currency",
            "cryptoMode": "Cryptocurrency",
            "exchangeRate": "Exchange Rate",
            "favoritePairs": "Popular Currency Pairs",
            "recentConversions": "Recent Conversions",
            "currency": "USD",
            "currencySymbol": "$",
            "locale": "en-US",
            "searchPlaceholder": "Search currency..."
        },
        "zh": {
            "langCode": "zh-CN", "dir": "ltr",
            "pageTitle": "汇率转换器 - 实时汇率和加密货币计算器",
            "metaDescription": "转换200+种货币和50+种加密货币的实时汇率。用于旅行、交易和购物的免费在线计算器。",
            "metaKeywords": "汇率转换器, 汇率计算器, 加密货币转换器, 比特币, 实时汇率",
            "headerTitle": "汇率转换器",
            "headerSubtitle": "实时汇率和加密货币计算器",
            "fiatMode": "法定货币",
            "cryptoMode": "加密货币",
            "exchangeRate": "汇率",
            "favoritePairs": "热门货币对",
            "recentConversions": "最近转换",
            "currency": "CNY",
            "currencySymbol": "¥",
            "locale": "zh-CN",
            "searchPlaceholder": "搜索货币..."
        },
        "es": {
            "langCode": "es", "dir": "ltr",
            "pageTitle": "Conversor de Divisas - Tasas de Cambio en Tiempo Real y Calculadora Crypto",
            "metaDescription": "Convierte 200+ monedas y 50+ criptomonedas con tasas de cambio en tiempo real. Calculadora online gratuita para viajes, trading y compras.",
            "metaKeywords": "conversor de divisas, tipo de cambio, conversor crypto, bitcoin, tasas en tiempo real",
            "headerTitle": "Conversor de Divisas",
            "headerSubtitle": "Tasas de Cambio en Tiempo Real y Calculadora Crypto",
            "fiatMode": "Moneda Fiduciaria",
            "cryptoMode": "Criptomoneda",
            "exchangeRate": "Tipo de Cambio",
            "favoritePairs": "Pares de Monedas Populares",
            "recentConversions": "Conversiones Recientes",
            "currency": "EUR",
            "currencySymbol": "€",
            "locale": "es-ES",
            "searchPlaceholder": "Buscar moneda..."
        },
        "ar": {
            "langCode": "ar", "dir": "rtl",
            "pageTitle": "محول العملات - أسعار الصرف في الوقت الفعلي وحاسبة العملات المشفرة",
            "metaDescription": "تحويل 200+ عملة و 50+ عملة مشفرة بأسعار صرف فورية. حاسبة مجانية للسفر والتداول والتسوق.",
            "metaKeywords": "محول العملات, سعر الصرف, محول العملات المشفرة, بيتكوين, أسعار فورية",
            "headerTitle": "محول العملات",
            "headerSubtitle": "أسعار الصرف في الوقت الفعلي وحاسبة العملات المشفرة",
            "fiatMode": "العملات الورقية",
            "cryptoMode": "العملات المشفرة",
            "exchangeRate": "سعر الصرف",
            "favoritePairs": "أزواج العملات الشائعة",
            "recentConversions": "التحويلات الأخيرة",
            "currency": "SAR",
            "currencySymbol": "ر.س",
            "locale": "ar-SA",
            "searchPlaceholder": "البحث عن العملة..."
        },
        "pt": {
            "langCode": "pt-BR", "dir": "ltr",
            "pageTitle": "Conversor de Moedas - Taxas de Câmbio em Tempo Real e Calculadora Crypto",
            "metaDescription": "Converta 200+ moedas e 50+ criptomoedas com taxas de câmbio em tempo real. Calculadora online gratuita para viagens, trading e compras.",
            "metaKeywords": "conversor de moedas, taxa de câmbio, conversor crypto, bitcoin, taxas em tempo real",
            "headerTitle": "Conversor de Moedas",
            "headerSubtitle": "Taxas de Câmbio em Tempo Real e Calculadora Crypto",
            "fiatMode": "Moeda Fiduciária",
            "cryptoMode": "Criptomoeda",
            "exchangeRate": "Taxa de Câmbio",
            "favoritePairs": "Pares de Moedas Populares",
            "recentConversions": "Conversões Recentes",
            "currency": "BRL",
            "currencySymbol": "R$",
            "locale": "pt-BR",
            "searchPlaceholder": "Pesquisar moeda..."
        },
        "hi": {
            "langCode": "hi", "dir": "ltr",
            "pageTitle": "मुद्रा परिवर्तक - रियल टाइम विनिमय दरें और क्रिप्टो कैलकुलेटर",
            "metaDescription": "200+ मुद्राओं और 50+ क्रिप्टोकरेंसी को रियल टाइम विनिमय दरों के साथ परिवर्तित करें। यात्रा, ट्रेडिंग और शॉपिंग के लिए मुफ्त ऑनलाइन कैलकुलेटर।",
            "metaKeywords": "मुद्रा परिवर्तक, विनिमय दर, क्रिप्टो परिवर्तक, बिटकॉइन, रियल टाइम दरें",
            "headerTitle": "मुद्रा परिवर्तक",
            "headerSubtitle": "रियल टाइम विनिमय दरें और क्रिप्टो कैलकुलेटर",
            "fiatMode": "फिएट मुद्रा",
            "cryptoMode": "क्रिप्टोकरेंसी",
            "exchangeRate": "विनिमय दर",
            "favoritePairs": "लोकप्रिय मुद्रा जोड़े",
            "recentConversions": "हाल के रूपांतरण",
            "currency": "INR",
            "currencySymbol": "₹",
            "locale": "hi-IN",
            "searchPlaceholder": "मुद्रा खोजें..."
        },
        "id": {
            "langCode": "id", "dir": "ltr",
            "pageTitle": "Konverter Mata Uang - Nilai Tukar Real-Time & Kalkulator Crypto",
            "metaDescription": "Konversi 200+ mata uang dan 50+ cryptocurrency dengan nilai tukar real-time. Kalkulator online gratis untuk perjalanan, trading, dan belanja.",
            "metaKeywords": "konverter mata uang, nilai tukar, konverter crypto, bitcoin, nilai real-time",
            "headerTitle": "Konverter Mata Uang",
            "headerSubtitle": "Nilai Tukar Real-Time & Kalkulator Crypto",
            "fiatMode": "Mata Uang Fiat",
            "cryptoMode": "Cryptocurrency",
            "exchangeRate": "Nilai Tukar",
            "favoritePairs": "Pasangan Mata Uang Populer",
            "recentConversions": "Konversi Terbaru",
            "currency": "IDR",
            "currencySymbol": "Rp",
            "locale": "id-ID",
            "searchPlaceholder": "Cari mata uang..."
        },
        "de": {
            "langCode": "de", "dir": "ltr",
            "pageTitle": "Währungsrechner - Echtzeit-Wechselkurse & Krypto-Rechner",
            "metaDescription": "Konvertieren Sie 200+ Währungen und 50+ Kryptowährungen mit Echtzeit-Wechselkursen. Kostenloser Online-Rechner für Reisen, Trading und Shopping.",
            "metaKeywords": "währungsrechner, wechselkurs, krypto rechner, bitcoin, echtzeit kurse",
            "headerTitle": "Währungsrechner",
            "headerSubtitle": "Echtzeit-Wechselkurse & Krypto-Rechner",
            "fiatMode": "Fiat-Währung",
            "cryptoMode": "Kryptowährung",
            "exchangeRate": "Wechselkurs",
            "favoritePairs": "Beliebte Währungspaare",
            "recentConversions": "Letzte Umrechnungen",
            "currency": "EUR",
            "currencySymbol": "€",
            "locale": "de-DE",
            "searchPlaceholder": "Währung suchen..."
        },
        "fr": {
            "langCode": "fr", "dir": "ltr",
            "pageTitle": "Convertisseur de Devises - Taux de Change en Temps Réel & Calculatrice Crypto",
            "metaDescription": "Convertissez 200+ devises et 50+ cryptomonnaies avec des taux de change en temps réel. Calculatrice en ligne gratuite pour voyages, trading et shopping.",
            "metaKeywords": "convertisseur devises, taux de change, convertisseur crypto, bitcoin, taux temps réel",
            "headerTitle": "Convertisseur de Devises",
            "headerSubtitle": "Taux de Change en Temps Réel & Calculatrice Crypto",
            "fiatMode": "Devise Fiduciaire",
            "cryptoMode": "Cryptomonnaie",
            "exchangeRate": "Taux de Change",
            "favoritePairs": "Paires de Devises Populaires",
            "recentConversions": "Conversions Récentes",
            "currency": "EUR",
            "currencySymbol": "€",
            "locale": "fr-FR",
            "searchPlaceholder": "Rechercher devise..."
        },
        "ja": {
            "langCode": "ja", "dir": "ltr",
            "pageTitle": "通貨コンバーター - リアルタイム為替レート＆仮想通貨計算機",
            "metaDescription": "200以上の通貨と50以上の仮想通貨をリアルタイム為替レートで変換。旅行、取引、ショッピング用の無料オンライン計算機。",
            "metaKeywords": "通貨コンバーター, 為替レート, 仮想通貨コンバーター, ビットコイン, リアルタイムレート",
            "headerTitle": "通貨コンバーター",
            "headerSubtitle": "リアルタイム為替レート＆仮想通貨計算機",
            "fiatMode": "法定通貨",
            "cryptoMode": "仮想通貨",
            "exchangeRate": "為替レート",
            "favoritePairs": "人気通貨ペア",
            "recentConversions": "最近の変換",
            "currency": "JPY",
            "currencySymbol": "¥",
            "locale": "ja-JP",
            "searchPlaceholder": "通貨を検索..."
        },
        "ru": {
            "langCode": "ru", "dir": "ltr",
            "pageTitle": "Конвертер Валют - Курсы Валют в Реальном Времени и Крипто Калькулятор",
            "metaDescription": "Конвертируйте 200+ валют и 50+ криптовалют с курсами в реальном времени. Бесплатный онлайн калькулятор для путешествий, торговли и покупок.",
            "metaKeywords": "конвертер валют, курс валют, крипто конвертер, биткоин, курсы реального времени",
            "headerTitle": "Конвертер Валют",
            "headerSubtitle": "Курсы Валют в Реальном Времени и Крипто Калькулятор",
            "fiatMode": "Фиатная Валюта",
            "cryptoMode": "Криптовалюта",
            "exchangeRate": "Курс Валют",
            "favoritePairs": "Популярные Валютные Пары",
            "recentConversions": "Недавние Конвертации",
            "currency": "RUB",
            "currencySymbol": "₽",
            "locale": "ru-RU",
            "searchPlaceholder": "Поиск валюты..."
        }
    };

    // --- CURRENCY DATA ---
    const fiatCurrencies = {
        'USD': 'US Dollar', 'EUR': 'Euro', 'GBP': 'British Pound', 'JPY': 'Japanese Yen', 
        'KRW': 'South Korean Won', 'CNY': 'Chinese Yuan', 'CAD': 'Canadian Dollar', 
        'AUD': 'Australian Dollar', 'CHF': 'Swiss Franc', 'HKD': 'Hong Kong Dollar',
        'SGD': 'Singapore Dollar', 'THB': 'Thai Baht', 'MYR': 'Malaysian Ringgit',
        'IDR': 'Indonesian Rupiah', 'PHP': 'Philippine Peso', 'VND': 'Vietnamese Dong',
        'INR': 'Indian Rupee', 'BRL': 'Brazilian Real', 'MXN': 'Mexican Peso',
        'ZAR': 'South African Rand', 'RUB': 'Russian Ruble', 'TRY': 'Turkish Lira',
        'SAR': 'Saudi Riyal', 'AED': 'UAE Dirham', 'EGP': 'Egyptian Pound',
        'NOK': 'Norwegian Krone', 'SEK': 'Swedish Krona', 'DKK': 'Danish Krone',
        'PLN': 'Polish Zloty', 'CZK': 'Czech Koruna', 'HUF': 'Hungarian Forint',
        'BGN': 'Bulgarian Lev', 'RON': 'Romanian Leu', 'HRK': 'Croatian Kuna',
        'ISK': 'Icelandic Krona', 'NZD': 'New Zealand Dollar', 'TWD': 'Taiwan Dollar',
        'KZT': 'Kazakhstani Tenge', 'UZS': 'Uzbekistani Som', 'UAH': 'Ukrainian Hryvnia',
        'BYN': 'Belarusian Ruble', 'MDL': 'Moldovan Leu', 'GEL': 'Georgian Lari',
        'AMD': 'Armenian Dram', 'AZN': 'Azerbaijani Manat', 'TMT': 'Turkmenistani Manat',
        'KGS': 'Kyrgyzstani Som', 'TJS': 'Tajikistani Somoni', 'AFN': 'Afghan Afghani',
        'PKR': 'Pakistani Rupee', 'BDT': 'Bangladeshi Taka', 'LKR': 'Sri Lankan Rupee',
        'NPR': 'Nepalese Rupee', 'BTN': 'Bhutanese Ngultrum', 'MVR': 'Maldivian Rufiyaa',
        'MMK': 'Myanmar Kyat', 'LAK': 'Laotian Kip', 'KHR': 'Cambodian Riel',
        'BND': 'Brunei Dollar', 'FJD': 'Fijian Dollar', 'PGK': 'Papua New Guinean Kina',
        'TON': 'Tongan Paʻanga', 'WST': 'Samoan Tala', 'VUV': 'Vanuatu Vatu',
        'SBD': 'Solomon Islands Dollar', 'NCL': 'New Caledonian Franc', 'XPF': 'CFP Franc'
    };

    const topCryptos = [
        'BTC', 'ETH', 'BNB', 'XRP', 'ADA', 'SOL', 'DOGE', 'DOT', 'MATIC', 'LTC',
        'SHIB', 'TRX', 'AVAX', 'DAI', 'LINK', 'ATOM', 'XMR', 'ETC', 'BCH', 'NEAR',
        'ICP', 'VET', 'FIL', 'MANA', 'SAND', 'AXS', 'THETA', 'ALGO', 'XTZ', 'EGLD',
        'FLOW', 'APE', 'CHZ', 'MINA', 'QNT', 'FTM', 'EOS', 'KCS', 'GT', 'HT',
        'LRC', 'CRV', 'ZEC', 'ENJ', 'BAT', 'COMP', 'YFI', 'UNI', 'SUSHI', 'CAKE'
    ];

    const cryptoNames = {
        'BTC': 'Bitcoin', 'ETH': 'Ethereum', 'BNB': 'Binance Coin', 'XRP': 'Ripple',
        'ADA': 'Cardano', 'SOL': 'Solana', 'DOGE': 'Dogecoin', 'DOT': 'Polkadot',
        'MATIC': 'Polygon', 'LTC': 'Litecoin', 'SHIB': 'Shiba Inu', 'TRX': 'Tron',
        'AVAX': 'Avalanche', 'DAI': 'Dai', 'LINK': 'Chainlink', 'ATOM': 'Cosmos',
        'XMR': 'Monero', 'ETC': 'Ethereum Classic', 'BCH': 'Bitcoin Cash', 'NEAR': 'Near Protocol',
        'ICP': 'Internet Computer', 'VET': 'VeChain', 'FIL': 'Filecoin', 'MANA': 'Decentraland',
        'SAND': 'The Sandbox', 'AXS': 'Axie Infinity', 'THETA': 'Theta Network', 'ALGO': 'Algorand',
        'XTZ': 'Tezos', 'EGLD': 'Elrond', 'FLOW': 'Flow', 'APE': 'ApeCoin',
        'CHZ': 'Chiliz', 'MINA': 'Mina', 'QNT': 'Quant', 'FTM': 'Fantom',
        'EOS': 'EOS', 'KCS': 'KuCoin Shares', 'GT': 'GateToken', 'HT': 'Huobi Token',
        'LRC': 'Loopring', 'CRV': 'Curve DAO Token', 'ZEC': 'Zcash', 'ENJ': 'Enjin Coin',
        'BAT': 'Basic Attention Token', 'COMP': 'Compound', 'YFI': 'yearn.finance', 'UNI': 'Uniswap',
        'SUSHI': 'SushiSwap', 'CAKE': 'PancakeSwap'
    };

    // Regional favorite pairs
    const regionalFavorites = {
        'ko': [['KRW', 'USD'], ['KRW', 'JPY'], ['KRW', 'EUR'], ['KRW', 'CNY']],
        'en': [['USD', 'EUR'], ['USD', 'GBP'], ['USD', 'JPY'], ['USD', 'CAD']],
        'ja': [['JPY', 'USD'], ['JPY', 'KRW'], ['JPY', 'CNY'], ['JPY', 'EUR']],
        'zh': [['CNY', 'USD'], ['CNY', 'HKD'], ['CNY', 'JPY'], ['CNY', 'EUR']],
        'de': [['EUR', 'USD'], ['EUR', 'GBP'], ['EUR', 'CHF'], ['EUR', 'JPY']],
        'fr': [['EUR', 'USD'], ['EUR', 'GBP'], ['EUR', 'CHF'], ['EUR', 'CAD']],
        'es': [['EUR', 'USD'], ['EUR', 'MXN'], ['EUR', 'GBP'], ['EUR', 'CAD']],
        'pt': [['BRL', 'USD'], ['BRL', 'EUR'], ['BRL', 'GBP'], ['BRL', 'ARS']],
        'ar': [['SAR', 'USD'], ['SAR', 'AED'], ['SAR', 'EGP'], ['SAR', 'EUR']],
        'hi': [['INR', 'USD'], ['INR', 'EUR'], ['INR', 'GBP'], ['INR', 'AED']],
        'id': [['IDR', 'USD'], ['IDR', 'SGD'], ['IDR', 'MYR'], ['IDR', 'EUR']],
        'ru': [['RUB', 'USD'], ['RUB', 'EUR'], ['RUB', 'CNY'], ['RUB', 'KZT']]
    };

    // --- GLOBAL VARIABLES ---
    let currentLang = 'ko';
    let currentMode = 'fiat';
    let exchangeRateCache = {};
    let conversionHistory = JSON.parse(localStorage.getItem('conversionHistory') || '[]');
    let selectedFromCurrency = 'KRW';
    let selectedToCurrency = 'USD';

    // --- LANGUAGE FUNCTIONS ---
    function getInitialLanguage() {
        const urlParams = new URLSearchParams(window.location.search);
        const lang = urlParams.get('lang');
        if (lang && Object.keys(translations).includes(lang)) {
            return lang;
        }
        const browserLang = navigator.language.split('-')[0];
        return Object.keys(translations).includes(browserLang) ? browserLang : 'ko';
    }

    function setLanguage(lang) {
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('lang') !== lang) {
            urlParams.set('lang', lang);
            history.replaceState(null, '', `${window.location.pathname}?${urlParams}`);
        }
        
        currentLang = lang;
        const t = translations[lang];

        document.documentElement.lang = t.langCode;
        document.body.dir = t.dir;

        // Update meta tags
        document.title = t.pageTitle;
        document.querySelector('meta[name="description"]').content = t.metaDescription;
        document.querySelector('meta[name="keywords"]').content = t.metaKeywords;
        
        // Update Open Graph tags
        document.querySelector('meta[property="og:title"]').content = t.pageTitle;
        document.querySelector('meta[property="og:description"]').content = t.metaDescription;
        document.querySelector('meta[property="og:locale"]').content = t.langCode.replace('-', '_');
        
        // Update Twitter Card tags
        document.querySelector('meta[name="twitter:title"]').content = t.pageTitle;
        document.querySelector('meta[name="twitter:description"]').content = t.metaDescription;

        // Generate and update hreflang links
        const head = document.querySelector('head');
        head.querySelectorAll('link[rel="alternate"]').forEach(link => link.remove());
        Object.keys(translations).forEach(code => {
            const link = document.createElement('link');
            link.rel = 'alternate';
            link.hreflang = translations[code].langCode.toLowerCase();
            link.href = `https://tjq8288.github.io/currency-converter/?lang=${code}`;
            head.appendChild(link);
        });
        const xDefault = document.createElement('link');
        xDefault.rel = 'alternate';
        xDefault.hreflang = 'x-default';
        xDefault.href = `https://tjq8288.github.io/currency-converter/?lang=en`;
        head.appendChild(xDefault);

        // Apply translations
        document.querySelectorAll('[data-translate]').forEach(el => {
            const key = el.getAttribute('data-translate');
            if (t[key]) el.textContent = t[key];
        });

        // Update search placeholders
        document.getElementById('fromCurrencySearch').placeholder = t.searchPlaceholder;
        document.getElementById('toCurrencySearch').placeholder = t.searchPlaceholder;

        // Update favorite pairs
        updateFavoritePairs();
    }

    function createLanguageSelector() {
        const container = document.getElementById('language-selector');
        const select = document.createElement('select');
        select.id = 'lang-switcher';
        
        const langNames = {
            'ko': '한국어', 'en': 'English', 'zh': '中文', 'es': 'Español',
            'ar': 'العربية', 'pt': 'Português', 'hi': 'हिन्दी', 'id': 'Indonesia',
            'de': 'Deutsch', 'fr': 'Français', 'ja': '日本語', 'ru': 'Русский'
        };

        Object.entries(langNames).forEach(([code, name]) => {
            const option = document.createElement('option');
            option.value = code;
            option.textContent = name;
            select.appendChild(option);
        });
        
        select.value = currentLang;
        select.addEventListener('change', (e) => setLanguage(e.target.value));
        container.appendChild(select);
    }

    // --- CUSTOM DROPDOWN FUNCTIONS ---
    function createCustomDropdown(type) {
        const currencies = currentMode === 'fiat' ? fiatCurrencies : cryptoNames;
        const optionsContainer = document.getElementById(`${type}CurrencyOptions`);
        const searchInput = document.getElementById(`${type}CurrencySearch`);
        
        optionsContainer.innerHTML = '';
        
        Object.entries(currencies).forEach(([code, name]) => {
            const option = document.createElement('div');
            option.className = 'dropdown-option';
            option.textContent = `${code} - ${name}`;
            option.dataset.code = code;
            option.dataset.name = name;
            
            if ((type === 'from' && code === selectedFromCurrency) || 
                (type === 'to' && code === selectedToCurrency)) {
                option.classList.add('selected');
            }
            
            option.addEventListener('click', () => {
                selectCurrency(type, code, name);
                closeDropdown(type);
            });
            
            optionsContainer.appendChild(option);
        });
        
        // Setup search functionality
        searchInput.addEventListener('input', (e) => {
            const filter = e.target.value.toLowerCase();
            const options = optionsContainer.querySelectorAll('.dropdown-option');
            
            options.forEach(option => {
                const text = option.textContent.toLowerCase();
                option.style.display = text.includes(filter) ? 'block' : 'none';
            });
        });
    }

    function selectCurrency(type, code, name) {
        if (type === 'from') {
            selectedFromCurrency = code;
            document.getElementById('fromCurrencyText').textContent = `${code} - ${name}`;
        } else {
            selectedToCurrency = code;
            document.getElementById('toCurrencyText').textContent = `${code} - ${name}`;
        }
        
        // Clear search
        document.getElementById(`${type}CurrencySearch`).value = '';
        
        // Update selected states
        createCustomDropdown(type);
        
        // Convert currency
        convertCurrency();
    }

    function toggleDropdown(type) {
        const dropdown = document.getElementById(`${type}CurrencyDropdown`);
        const button = document.getElementById(`${type}CurrencyButton`);
        const isOpen = dropdown.classList.contains('open');
        
        // Close all dropdowns first
        closeAllDropdowns();
        
        if (!isOpen) {
            dropdown.classList.add('open');
            button.classList.add('open');
            
            // Focus search input
            setTimeout(() => {
                document.getElementById(`${type}CurrencySearch`).focus();
            }, 100);
        }
    }

    function closeDropdown(type) {
        const dropdown = document.getElementById(`${type}CurrencyDropdown`);
        const button = document.getElementById(`${type}CurrencyButton`);
        
        dropdown.classList.remove('open');
        button.classList.remove('open');
        
        // Clear search
        document.getElementById(`${type}CurrencySearch`).value = '';
        
        // Reset options display
        const options = dropdown.querySelectorAll('.dropdown-option');
        options.forEach(option => option.style.display = 'block');
    }

    function closeAllDropdowns() {
        closeDropdown('from');
        closeDropdown('to');
    }

    function setupDropdownEventListeners() {
        // Button click events
        document.getElementById('fromCurrencyButton').addEventListener('click', (e) => {
            e.stopPropagation();
            toggleDropdown('from');
        });
        
        document.getElementById('toCurrencyButton').addEventListener('click', (e) => {
            e.stopPropagation();
            toggleDropdown('to');
        });
        
        // Close dropdowns when clicking outside
        document.addEventListener('click', closeAllDropdowns);
        
        // Prevent dropdown close when clicking inside
        document.getElementById('fromCurrencyDropdown').addEventListener('click', (e) => {
            e.stopPropagation();
        });
        
        document.getElementById('toCurrencyDropdown').addEventListener('click', (e) => {
            e.stopPropagation();
        });
    }

    async function getExchangeRate(from, to) {
        const cacheKey = `${from}-${to}`;
        
        // Check cache (valid for 5 minutes)
        if (exchangeRateCache[cacheKey] && 
            Date.now() - exchangeRateCache[cacheKey].timestamp < 300000) {
            return exchangeRateCache[cacheKey].rate;
        }

        try {
            const response = await fetch(
                `https://cdn.jsdelivr.net/npm/@fawazahmed0/currency-api@latest/v1/currencies/${from.toLowerCase()}.json`
            );
            
            if (!response.ok) throw new Error('API request failed');
            
            const data = await response.json();
            const rate = data[from.toLowerCase()][to.toLowerCase()];
            
            if (!rate) throw new Error('Exchange rate not found');

            // Cache the result
            exchangeRateCache[cacheKey] = {
                rate: rate,
                timestamp: Date.now()
            };

            return rate;
        } catch (error) {
            console.error('Exchange rate fetch error:', error);
            return null;
        }
    }

    async function convertCurrency() {
        const fromAmount = parseFloat(document.getElementById('fromAmount').value) || 0;
        const toAmountInput = document.getElementById('toAmount');
        const rateValue = document.getElementById('rateValue');

        if (fromAmount === 0) {
            toAmountInput.value = '0';
            rateValue.textContent = '-';
            return;
        }

        // Show loading
        toAmountInput.value = '⏳';
        rateValue.innerHTML = '<div class="loading"></div>';

        try {
            const rate = await getExchangeRate(selectedFromCurrency, selectedToCurrency);
            
            if (rate) {
                const convertedAmount = fromAmount * rate;
                toAmountInput.value = formatNumber(convertedAmount);
                rateValue.textContent = `1 ${selectedFromCurrency} = ${formatNumber(rate)} ${selectedToCurrency}`;

                // Add to history
                addToHistory(selectedFromCurrency, selectedToCurrency, fromAmount, convertedAmount, rate);
            } else {
                toAmountInput.value = 'Error';
                rateValue.textContent = 'Rate unavailable';
                showMessage('환율 정보를 가져올 수 없습니다.', 'error');
            }
        } catch (error) {
            toAmountInput.value = 'Error';
            rateValue.textContent = 'Error';
            showMessage('변환 중 오류가 발생했습니다.', 'error');
        }
    }

    function formatNumber(num) {
        if (num >= 1) {
            return new Intl.NumberFormat(translations[currentLang].locale, {
                minimumFractionDigits: 2,
                maximumFractionDigits: 6
            }).format(num);
        } else {
            return new Intl.NumberFormat(translations[currentLang].locale, {
                minimumFractionDigits: 2,
                maximumFractionDigits: 8
            }).format(num);
        }
    }

    function addToHistory(from, to, fromAmount, toAmount, rate) {
        const historyItem = {
            from,
            to,
            fromAmount,
            toAmount,
            rate,
            timestamp: Date.now()
        };

        conversionHistory.unshift(historyItem);
        conversionHistory = conversionHistory.slice(0, 10);
        
        localStorage.setItem('conversionHistory', JSON.stringify(conversionHistory));
        updateHistoryDisplay();
    }

    function updateHistoryDisplay() {
        const historyContainer = document.getElementById('conversionHistory');
        historyContainer.innerHTML = '';

        if (conversionHistory.length === 0) {
            historyContainer.innerHTML = '<div style="text-align: center; color: #64748b;">No recent conversions</div>';
            return;
        }

        conversionHistory.forEach(item => {
            const historyItem = document.createElement('div');
            historyItem.className = 'history-item';
            
            const conversionText = document.createElement('div');
            conversionText.className = 'history-conversion';
            conversionText.textContent = `${formatNumber(item.fromAmount)} ${item.from} → ${formatNumber(item.toAmount)} ${item.to}`;
            
            const timeText = document.createElement('div');
            timeText.className = 'history-time';
            timeText.textContent = new Date(item.timestamp).toLocaleTimeString();
            
            historyItem.appendChild(conversionText);
            historyItem.appendChild(timeText);
            historyContainer.appendChild(historyItem);
        });
    }

    function updateFavoritePairs() {
        const favoritePairsContainer = document.getElementById('favoritePairs');
        favoritePairsContainer.innerHTML = '';

        const favorites = regionalFavorites[currentLang] || regionalFavorites['en'];
        
        favorites.forEach(([from, to]) => {
            const pairDiv = document.createElement('div');
            pairDiv.className = 'favorite-pair';
            pairDiv.textContent = `${from}/${to}`;
            pairDiv.addEventListener('click', () => {
                const currencies = currentMode === 'fiat' ? fiatCurrencies : cryptoNames;
                if (currencies[from] && currencies[to]) {
                    selectCurrency('from', from, currencies[from]);
                    selectCurrency('to', to, currencies[to]);
                }
            });
            favoritePairsContainer.appendChild(pairDiv);
        });
    }

    function showMessage(message, type = 'success') {
        const existingMessage = document.querySelector('.error-message, .success-message');
        if (existingMessage) existingMessage.remove();

        const messageDiv = document.createElement('div');
        messageDiv.className = type === 'error' ? 'error-message' : 'success-message';
        messageDiv.textContent = message;
        
        document.querySelector('.converter-section').appendChild(messageDiv);
        
        setTimeout(() => messageDiv.remove(), 3000);
    }

    // --- EVENT LISTENERS ---
    function initializeEventListeners() {
        // Mode toggle
        document.querySelectorAll('.toggle-option').forEach(option => {
            option.addEventListener('click', () => {
                document.querySelectorAll('.toggle-option').forEach(opt => opt.classList.remove('active'));
                option.classList.add('active');
                
                currentMode = option.dataset.mode;
                
                // Set default currencies for new mode
                if (currentMode === 'fiat') {
                    const t = translations[currentLang];
                    selectedFromCurrency = t.currency;
                    selectedToCurrency = 'USD';
                } else {
                    selectedFromCurrency = 'BTC';
                    selectedToCurrency = 'USD';
                }
                
                // Update dropdown content
                createCustomDropdown('from');
                createCustomDropdown('to');
                
                // Update button text
                const currencies = currentMode === 'fiat' ? fiatCurrencies : cryptoNames;
                document.getElementById('fromCurrencyText').textContent = `${selectedFromCurrency} - ${currencies[selectedFromCurrency]}`;
                document.getElementById('toCurrencyText').textContent = `${selectedToCurrency} - ${currencies[selectedToCurrency]}`;
                
                convertCurrency();
            });
        });

        // Currency conversion
        document.getElementById('fromAmount').addEventListener('input', convertCurrency);

        // Swap button
        document.getElementById('swapButton').addEventListener('click', () => {
            const tempCurrency = selectedFromCurrency;
            const tempCurrencyName = document.getElementById('fromCurrencyText').textContent;
            
            // Swap currencies
            selectedFromCurrency = selectedToCurrency;
            selectedToCurrency = tempCurrency;
            
            // Update display
            document.getElementById('fromCurrencyText').textContent = document.getElementById('toCurrencyText').textContent;
            document.getElementById('toCurrencyText').textContent = tempCurrencyName;
            
            // Swap amounts
            const fromAmount = document.getElementById('fromAmount');
            const toAmount = document.getElementById('toAmount');
            const tempAmount = fromAmount.value;
            fromAmount.value = toAmount.value;
            toAmount.value = tempAmount;

            // Update dropdown selections
            createCustomDropdown('from');
            createCustomDropdown('to');
            
            convertCurrency();
        });

        // Quick amounts
        document.querySelectorAll('.quick-amount').forEach(button => {
            button.addEventListener('click', () => {
                const amount = button.dataset.amount.replace(',', '');
                document.getElementById('fromAmount').value = amount;
                convertCurrency();
            });
        });
    }

    // --- INITIALIZATION ---
    function initialize() {
        const initialLang = getInitialLanguage();
        setLanguage(initialLang);
        createLanguageSelector();
        
        // Setup initial dropdowns
        createCustomDropdown('from');
        createCustomDropdown('to');
        setupDropdownEventListeners();
        
        updateHistoryDisplay();
        initializeEventListeners();

        // Initial conversion
        setTimeout(() => convertCurrency(), 500);
    }

    initialize();
});
</script>
</body>
</html>
